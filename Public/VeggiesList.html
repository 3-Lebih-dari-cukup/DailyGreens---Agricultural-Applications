<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DailyGreens - Website Pertanian</title>
    <link rel="stylesheet" href="src/output.css">
    <script src='https://cdn.tailwindcss.com'></script>
</head>
<style>
    .product-list {
        display: flex;
        flex-wrap: wrap;
        justify-content: center; 
    }
    .product {
        width: 300px; 
        margin: 10px;
        display: flex;
        flex-direction: column;
    }

    .product-img {
        margin-bottom: 15px;
        align-items: center;
        width: 200px; 
        height: 250px; 
        object-fit: contain; 
    }

    .product-content {
        flex: 1; 
        display: flex;
        flex-direction: column;
    }

    .product-title {
        margin-bottom: 10px;
    }

    .product-desc {
        flex: 1; 
        overflow: hidden; 
    }

    .product-actions {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 10px; 
    }

    .product-price {
        font-weight: bold;
        font-size: 1.25rem;
    }

</style>
<body class="font-sans">
    <h1 class="font-bold text-4xl text-center p-16">VEGETABLES</h1>

    <!-- List Produk -->
    <div class="product-list">
        <script>
            document.addEventListener("DOMContentLoaded", async function(){
                let product = document.querySelector('.product-list'); 
                
                async function deleteProduct(id){
                    try {
                        let confirmation = window.confirm('Are you sure you want to delete this product?');

                        if (confirmation){
                            let response = await fetch(`https://fakestoreapi.com/products/${id}`, {
                                method: 'DELETE'
                            });

                            if (response.ok) {
                                console.log('Produk telah dihapus');
                                document.querySelector('[data-productid="${id}"]').closest('.product').remove();
                            } else {
                                console.log('Gagal menghapus produk');
                            }
                        }
                    } catch (error) {
                        console.log('error', error);
                    }
                }           

            // listener delete button
            product.addEventListener('click', async function(event) {
                if (event.target.classList.contains('delete-product')) {
                    let productId = event.target.dataset.productid;
                    await deleteProduct(productId);
                    event.target.closest('.product').remove();
                }
            });

                async function fetchProductList(url){
                    try {
                        let data = await fetch(url);
                        let response = await data.json();
        
                        for(let i = 0; i < response.length; i++){
                            let description = response[i].description;
                            let title = response[i].title;
                            product.innerHTML += `
                            <div class="product rounded-xl border border-gray-300 rounded-lg shadow-md p-4 mb-4 flex">
                                <div class="flex flex-col items-center">
                                    <img src="${response[i].image}" alt="" class="product-img mb-2 ">
                                </div>
                                <div class="product-content">
                                    <h2 class="product-title text-lg font-bold">${title.length > 15 ? title.slice(0, 24) + '...' : title}</h2>
                                    <p class="product-desc">${description.length > 20 ? description.slice(0, 150) + '...more' : description}</p>
                                </div>
                                <div class="product-actions">
                                    <div>
                                        <h3 class="product-price">${response[i].price}$</h3>
                                        <p class="text-sm"> Stock 23</p> 
                                        <p class="text-s mt-4">⚲ Bojongsoang</p>
                                        <h6 class="mt-1 text-center font-bold bg-green-300 p-1 rounded border rounded-xl">SiHijau ☑️</h6>
                                    </div>
                                </div>
                                <div class="flex mt-8 mb-4 space-x-1.5 self-center">
                                    <a href="#!" data-productID="${response[i].id}" class="rounded-xl px-9 bg-blue-500 hover:bg-white text-white hover:text-blue-500 font-bold py-2 px-4 rounded border border-blue-500">Edit</a>
                                    <a href="#!" data-productid="${response[i].id}" class="delete-product rounded-xl px-7 hover:bg-red-700 text-red-700 hover:text-white font-bold py-2 px-4 rounded border border-red-500 hover:border-red-700">Delete</a>
                                </div>
                            </div>
                            `;
                        }
                    } catch (error) {
                        console.error('Error fetching data:', error);
                    }
                }


        
                fetchProductList('https://fakestoreapi.com/products');
            });
        </script>
    </div>
    <div class="fixed bottom-0 w-full flex flex-col items-end">
        <button class='mr-8 my-8 ml-auto px-5 py-2 bg-green-500 text-white text-sm font-bold tracking-wide rounded-full focus:outline-none'>+ ADD</button>
    </div>
</body>
</html>
